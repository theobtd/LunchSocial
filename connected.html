<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>You are Connected</title>
    <link rel="stylesheet" href="styles.css"> <!-- Link to external CSS -->
    <script src="https://www.gstatic.com/firebasejs/9.9.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.9.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.9.0/firebase-database-compat.js"></script>
    <script src="firebase.js"></script> <!-- Link to Firebase initialization -->
    <script src="events.js"></script> <!-- Link to event functions -->
    <script src="user.js"></script> <!-- Link to user functions -->
    <script src="modal.js"></script> <!-- Link to modal functions -->
</head>
<body>
    <div class="sidebar">
        <h2>You are connected</h2>
        <button id="logoutBtn">Log Out</button>
        <button id="createEventBtn">Create Event</button>

        <h3>All Users</h3>
        <div class="user-list" id="userList"></div>

        <h3>Pending Friend Requests</h3>
        <div class="request-list" id="requestList"></div>

        <h3>Accepted Friends</h3>
        <div class="accepted-list" id="acceptedList"></div>
    </div>

    <div class="main-content">
        <h3>Your Events</h3>
        <div class="event-list" id="eventList"></div>

        <h3>Friends' Events</h3>
        <div class="friends-event-list" id="friendsEventList"></div>
    </div>

    <!-- Modal for Event Creation -->
    <div id="eventModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h3>Create Event</h3>
            <label for="eventTitle">Event Title:</label>
            <input type="text" id="eventTitle" required>
            <br>
            <label for="eventDate">Event Date:</label>
            <input type="date" id="eventDate" required>
            <br>
            <label for="eventTime">Event Time:</label>
            <input type="time" id="eventTime" required step="900"> <!-- Step set to 900 seconds for 15-minute intervals -->
            <br>
            <button id="submitEventBtn">Create Event</button>
        </div>
    </div>

    <script>
        // Initialize Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyBB61hJK8iHNAXz2q5u8ghGqIFMyJh-Nho",
            authDomain: "aperosocial-d53c7.firebaseapp.com",
            databaseURL: "https://aperosocial-d53c7-default-rtdb.firebaseio.com",
            projectId: "aperosocial-d53c7",
            storageBucket: "aperosocial-d53c7.appspot.com",
            messagingSenderId: "954205055992",
            appId: "1:954205055992:web:c2ebebe1c0ac210163440d"
        };

        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const database = firebase.database();

        // Fetch users and requests when the page loads
        auth.onAuthStateChanged(user => {
            if (user) {
                displayUsers();
                displayPendingRequests(); // Fetch and display pending friend requests
                displayAcceptedFriends(); // Fetch and display accepted friends
                displayEvents(); // Fetch and display user's events
                displayFriendsEvents(); // Fetch and display friends' events
            } else {
                window.location.href = 'index.html'; // Redirect if not logged in
            }
        });
    </script>
</body>
</html>
